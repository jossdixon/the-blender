<div class="container mt-5">
  <div class="card-group">
    <div class="img-back">
      <%= link_to users_path do %>
        <p><i class="fas fa-long-arrow-alt-left fa-2x ">Loan</i></p>
      <% end %>
      <%= link_to profiles_path do %>
        <p><i class="fas fa-long-arrow-alt-left fa-2x ">Profile</i></p>
      <% end %>
    </div>
    <div>
      <div class="d-flex justify-content-between">
      <h2>Loan #<%= @loan.id%></h2>
      <div><%= link_to "Add a loanee", new_loan_loanee_path(@loan.id), class:"btn btn-primary" %></div>
      </div>
      <br>
      <p><strong>Started On:</strong> <%= @loan.start_date.strftime("%A %b %d") %></p>
      <p><strong>Duration: </strong><%= @loan.weeks %> weeks</p>
      <table>
        <tr>
          <th></th>
          <th>Name</th>
          <th>Total Debt Amount</th>
          <th>Weekly Payment</th>
          <th>Loan Status</th>
          <th>Edit</th>
        </tr>
        <div style="text-align: center;">
          <div class="progress">
            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: <%= @percentage %>%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><%= @progress %>% Complete</div>
          </div>
          <br>
          <% @loan.loanees.each_with_index do |loanee| %>
            <tr>
              <td><%= cl_image_tag(loanee.user.profile.photo.key, :transformation=>[
                {:gravity=>"face", :height=>80, :width=>80, :crop=>"fill"}, {:radius=>"max"}]) %></td>
              <td><%= link_to loanee.user.full_name, profile_path(loanee.user.profile) %></td>
              <td><%= loanee.total %></td>
              <td><%= (loanee.total / @loan.weeks).round(2) %></td>
              <td><%= loanee.status %></td>
              <td><%= link_to edit_loanee_path(loanee.id) do %>
                  <i class="fas fa-edit"></i>
                <% end %>
              </td>
            </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>
</div>
